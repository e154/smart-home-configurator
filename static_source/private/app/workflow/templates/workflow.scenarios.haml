.row
  .col-md-6
    .row(if-can="{scenarios:['create']}")
      .col-md-12
        .form-group
          %a(href="#" ng-click="scenarios.addNew()")
            .fa.fa-plus &nbsp;
            {{'workflow.scenario.add' | translate}}

    %div
      %div(ng-include="'/workflow/templates/_scenario_form.html'" )

    .form-group
      .pull-right
        %a.btn.btn-danger(href="" role="button" ng-click="scenarios.remove()" ng-show="scenarios.current.id" if-can="{scenarios:['delete']}")
          {{'Delete' | translate}}
        %a.btn.btn-default(href="" role="button" ng-click="scenarios.cancel()" ng-if="scenarios.current.id")
          {{'Cancel' | translate}}
        %a.btn.btn-primary(href="" role="button" ng-click="scenarios.submit()")
          %span(ng-if="!scenarios.current.id" if-can="{scenarios:['create']}")
            {{'Create' | translate}}
          %span(ng-if="scenarios.current.id" if-can="{scenarios:['update']}")
            {{'Update' | translate}}
      .clearfix

  .col-md-6
    .list-group(ng-if="workflow.workflow.scenarios.length")
      .panel.panel-default
        .panel-heading
          {{'workflow.scenarios' | translate}}
        %a.list-group-item(href="#" ng-repeat="item in workflow.workflow.scenarios" ng-click="scenarios.show(item)" ng-class="{'active' : scenarios.current.id == item.id}" )
          %strong.list-group-item-heading
            {{item.name}}
            &nbsp;
            %i.fa.fa-check(ng-if="workflow.workflow.scenario.id == item.id")

          .pull-right.small
            {{'Updated at' | translate}} {{item.update_at | readableDateTime}}
          .clearfix
          .pull-right
            %button.btn.btn-success.btn-xs(ng-click="scenarios.update_scenario(item, $event)" type="button")
              .fa.fa-play
              &nbsp;
              {{'workflow.scenario.do_scenario' | translate}}
          .pull-left.list-group-item-text
            %div
              {{'workflow.scenario.system_name' | translate}}:
            .text-muted
              {{item.system_name}}
            %div
              {{'workflow.scripts' | translate}}:
            .text-muted(ng-if="!item.scripts.length")
              {{'No scripts' | translate}}
            .text-muted(ng-repeat="script in item.scripts")
              {{script.name}}({{script.lang}})
          .clearfix


.row(ng-if="scenarios.current.id")
  .col-lg-12
    %h4
      {{'workflow.scenario.scripts_title' | translate}}

.row(ng-if="scenarios.current.id")
  .col-lg-12
    %script-editor(ng-model="scenarios.current.scripts")

.row(ng-show="scenarios.current.id" if-can="{scenarios:['update']}")
  .col-lg-12.form-group
    .pull-right
      %a.btn.btn-primary(href="" role="button" ng-click="scenarios.submit()")
        {{'Update' | translate}}